<!doctype html>

<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>MinecraftJS</title>
  <script type="text/javascript" src="textures.js"></script>
  <script type="text/javascript" src="world-structures.js"></script>
  <script type="text/javascript" src="randomizer.js"></script>
  <script type="text/javascript">
  		// Spritesheet
		var spriteSheetWidth = 256; // TODO : récupérer witdh image
		var spriteSheetHeight = 256;
		var spriteSheetCols = 16;
		var spriteSheetRows = 16;
		var worldCols = 40;
		var worldRows = 32; 
		var ctx;
		var canvas;
		var spriteSheetImg

		// Sprite
		var spriteWidth = (spriteSheetWidth / spriteSheetCols);
		var spriteHeight = (spriteSheetHeight / spriteSheetRows);

		function initializeLevel() {
			canvas = document.getElementById("canvas");
		    if (canvas.getContext) {
		    	ctx = canvas.getContext("2d");
		    	ctx.scale(3, 3);
        	}

			spriteSheetImg = new Image();
			spriteSheetImg.src = "texture.png";
			spriteSheetImg.onload = start;
		}

		function start() {
			var canvasY = 0 - spriteHeight;
			var canvasX = 0 - spriteWidth;
		    for (var col = 0; col < worldCols; col++) {
		        for (var row = 0; row < worldRows; row++) {

		        	if (col < 5) {
			            var sourceX = Sky.posX * spriteWidth;
			            var sourceY = Sky.posY * spriteHeight;
		        	}

		        	if (col >= 5 && col < 6) {
			            var sourceX = Grass.posX * spriteWidth;
			            var sourceY = Grass.posY * spriteHeight;
		        	}

		        	if (col >= 6 && col < 10) {
			            var sourceX = Dirt.posX * spriteWidth;
			            var sourceY = Dirt.posY * spriteHeight;
		        	}

		        	if (col >= 10 && col < 20) {
		        		var randomStoneOrDirt = randomNumberFromList([Stone, Dirt])
			            var sourceX = randomStoneOrDirt.posX * spriteWidth;
			            var sourceY = randomStoneOrDirt.posY * spriteHeight;
		        	}

		        	if (col >= 20 && col < 38) {
			            var sourceX = Stone.posX * spriteWidth;
			            var sourceY = Stone.posY * spriteHeight;
		        	}

		        	if (col >= 38) {
			            var sourceX = Bedrock.posX * spriteWidth;
			            var sourceY = Bedrock.posY * spriteHeight;
		        	}

		            canvasX = row * spriteWidth;
		            canvasY = col * spriteHeight;

		            ctx.drawImage(spriteSheetImg,
		            sourceX, sourceY, spriteWidth, spriteHeight,
		            canvasX, canvasY, spriteWidth, spriteHeight);
		        }
		    }
		    drawTree(ctx, spriteSheetImg, 7,4);
		    drawTree(ctx, spriteSheetImg, 12,4);
		}
  </script>
	<style>
		body{ background-color: black; margin: 0; }
		canvas{ background-color: #6699ff; display: block; margin: 0 auto; }
	</style>
</head>
<body onload="initializeLevel()">
	<canvas id="canvas" width=1536 height=1920></canvas>
</body>
</html>